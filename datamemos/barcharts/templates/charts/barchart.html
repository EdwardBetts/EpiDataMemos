{% load as_percent %}

<div id="chart-{{chart.id}}" class="chart barchart" data-animation-time="750" >
	<h2 class="title">{{chart.title}}</h2>
	<div class="description">{{chart.description}}</div>
	<form class="controls">
		<fieldset class="filters">
			<legend><span>Select axis to view</span></legend>
			<ul class="nav tags">
			{% for row in rows %}
			<li>
				{% include "charts/row-control.html" with row=row %}
			</li>
			{% endfor %}
			</ul>
			{% for row in rows %}
			{% if row.children|length %}
			<ul class="tag tags-children nav" parent="{{row.short}}">
			{% for child in row.children %}
				<li>
				{% include "charts/row-control.html" with row=child %}
				</li>
			{% endfor %}
			</ul>
			{% endif %}
			{% endfor %}
		</fieldset>
		<!--
		<fieldset class="layout">
			<legend><span>Change layout of graph</span></legend>
			<label class="checkbox"><input class="percent" type="checkbox" name="percent" value="on" />View as percent per <span class="column_name">column</span></label>
		</fieldset>
		-->
	</form>
	<div class="canvas-container">
	<div class="y_label">{{chart.y_label}}</div>
	<div class="canvas">
	{% for column in columns %}
		<div class="column" value="{{column.short}}">
			<div class="label">{{column.label}}</div>
			<div class="bar-container">
			{% for point in column.points %}
			<div class="bar{% for row in point.rows %} {{row.short}}{% endfor %}"
				tags="{{column.short}}{% for row in point.rows %},{{row.short}}{% endfor %}"
				amount="{{point.value}}"
				total="{{point.total}}"
				percent="{{point.percent}}">
				<div class="amount">{{point.value}}</div>
				<div class="highlight">
					<div class="title title-hightlight">{% for row in point.rows %}{{row.name}}{% endfor %} in {{column.label}}</div>
					<div class="number">{{point.value}}</div>
					<div class="total">{{point.total}}</div>
					<div class="label">{{chart.y_label}}</div>
					<div class="percent">{{point.percent|as_percent}}</div>
					<div class="arrow"></div>
				</div>
			</div>
			{% endfor %}
			</div>
		</div>
	{% endfor %}	
	</div>
	<div class="x_label">{{chart.x_label}}</div>
	</div>
</div>